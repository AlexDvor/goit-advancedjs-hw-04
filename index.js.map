{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nclass Pixabay {\n  #API_KEY = '22579303-973b9b71134c76d3c38c0933d';\n  currentPage = 1;\n  queryField = '';\n\n  #getSearchParams(query) {\n    return {\n      key: this.#API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: this.currentPage,\n      per_page: 15,\n    };\n  }\n\n  incrementPage() {\n    this.currentPage++;\n  }\n\n  resetPage() {\n    this.currentPage = 1;\n  }\n\n  async getPhotoByQuery(query) {\n    this.queryField = query;\n    const response = await axios.get('', {\n      params: this.#getSearchParams(query),\n    });\n    return response.data;\n  }\n}\n\nexport const API = new Pixabay();\n","export const createImgCard = ({\n  downloads = 0,\n  comments = 0,\n  likes = 0,\n  views = 0,\n  webformatURL,\n  largeImageURL,\n  tags,\n}) => {\n  const refTag = tags.split(',')[0] || '';\n  return `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=${largeImageURL}>\n        <div class='gallery-thumb-image'>\n          <img class=\"gallery-image\" src=${webformatURL} data-source=${largeImageURL} alt=${refTag} />\n        </div>\n        <div class='wrapper-info'>\n          <div class='info'>\n            <p>Likes</p>\n            <p>${likes}</p>\n          </div>\n          <div class='info'>\n            <p>Views</p>\n            <p>${views}</p>\n          </div>\n          <div class='info'>\n            <p>Comments</p>\n            <p>${comments}</p>\n          </div>\n          <div class='info'>\n            <p>Downloads</p>\n            <p>${downloads}</p>\n          </div>\n        </div>\n      </a>\n    </li>\n`;\n};\n","import SimpleLightbox from 'simplelightbox';\nimport { API } from './js/pixabay-api';\nimport { createImgCard } from './js/render-functions';\nimport iziToast from 'izitoast';\n\nlet lightbox = null;\n\nconst refs = {\n  form: document.querySelector('.form'),\n  galleryList: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.js-load-more-btn'),\n  card: document.querySelector('.gallery-item'),\n};\n\nconst messageForUser = (ms, type) => {\n  if (type === 'error') {\n    iziToast.error({\n      message: ms,\n      position: 'topRight',\n    });\n  } else if (type === 'warning') {\n    iziToast.warning({\n      message: ms,\n      position: 'topRight',\n    });\n  } else {\n    iziToast.show({\n      message: ms,\n      position: 'topRight',\n    });\n  }\n};\n\nconst removeLoadMoreBtn = () => {\n  refs.loadMoreBtn.classList.add('inactive');\n  refs.loadMoreBtn.removeEventListener('click', onClickLoadMoreBtn);\n};\nconst addLoadMoreBtn = () => {\n  refs.loadMoreBtn.classList.remove('inactive');\n  refs.loadMoreBtn.addEventListener('click', onClickLoadMoreBtn);\n};\n\nconst getHeightEl = () => {\n  const htmlEl = refs.galleryList.children[0];\n  const { height } = htmlEl.getBoundingClientRect();\n\n  return height;\n};\n\nconst initOrRefreshLightbox = () => {\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery-link', {\n      captionsData: 'alt',\n      captionDelay: 250,\n      overlayOpacity: 0.9,\n    });\n  } else {\n    lightbox.refresh();\n  }\n};\n\nconst onClickLoadMoreBtn = async e => {\n  API.incrementPage();\n\n  try {\n    const { hits, totalHits } = await API.getPhotoByQuery(API.queryField);\n\n    if (hits.length === 0 && totalHits === 0) {\n      messageForUser(\n        'Sorry, there are no images matching your search query. Please try again!',\n        'error'\n      );\n      return;\n    }\n\n    const createGallery = hits.map(item => createImgCard(item)).join('');\n    refs.galleryList.insertAdjacentHTML('beforeend', createGallery);\n\n    const quantityEl = refs.galleryList.children.length;\n\n    window.scrollBy({\n      top: getHeightEl() * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n\n    initOrRefreshLightbox();\n\n    if (totalHits === quantityEl) {\n      messageForUser(\n        `We're sorry, but you've reached the end of search results.`,\n        'warning'\n      );\n      removeLoadMoreBtn();\n    }\n  } catch (error) {\n    messageForUser(error.message, 'error');\n    console.log(error);\n  }\n};\n\nconst onSubmitBtn = async e => {\n  e.preventDefault();\n  const form = e.target;\n  const formData = new FormData(form);\n  const searchField = formData.get('search-field').trim();\n\n  if (!searchField) {\n    messageForUser(\n      'The search field is empty. Please enter text to search.',\n      'warning'\n    );\n    return;\n  }\n\n  API.resetPage();\n  refs.loader.classList.add('is-loaded');\n\n  try {\n    const { hits, totalHits } = await API.getPhotoByQuery(searchField);\n\n    if (hits.length === 0) {\n      messageForUser(\n        'Sorry, there are no images matching your search query. Please try again!',\n        'error'\n      );\n      return;\n    }\n\n    const createGallery = hits.map(item => createImgCard(item)).join('');\n\n    refs.galleryList.innerHTML = createGallery;\n    const quantityEl = refs.galleryList.children.length;\n\n    if (totalHits === quantityEl) {\n      removeLoadMoreBtn();\n    } else {\n      addLoadMoreBtn();\n    }\n\n    initOrRefreshLightbox();\n  } catch (error) {\n    messageForUser(error.message, 'error');\n    refs.galleryList.innerHTML = '';\n    removeLoadMoreBtn();\n    console.log(error);\n  } finally {\n    refs.loader.classList.remove('is-loaded');\n  }\n};\n\nrefs.form.addEventListener('submit', onSubmitBtn);\n"],"names":["axios","Pixabay","__privateAdd","_Pixabay_instances","_API_KEY","__publicField","query","__privateMethod","getSearchParams_fn","__privateGet","API","createImgCard","downloads","comments","likes","views","webformatURL","largeImageURL","tags","refTag","lightbox","refs","messageForUser","ms","type","iziToast","removeLoadMoreBtn","onClickLoadMoreBtn","addLoadMoreBtn","getHeightEl","htmlEl","height","initOrRefreshLightbox","SimpleLightbox","e","hits","totalHits","createGallery","item","quantityEl","error","onSubmitBtn","form","searchField"],"mappings":"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"}